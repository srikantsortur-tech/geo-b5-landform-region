<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 9 Landform Regions Challenge</title>
    <!-- Load Tailwind CSS for modern, responsive styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for the geography theme */
        :root {
            --color-shield: #facc15; /* Yellow/Gold */
            --color-cordillera: #10b981; /* Green */
            --color-appalachians: #fb7185; /* Pink/Rose */
            --color-lowlands: #38bdf8; /* Sky Blue */
            --color-plains: #fb923c; /* Orange */
            --color-bg: #1f2937; /* Dark Slate */
            --color-text: #f9fafb; /* Light Gray */
            --color-card: #374151; /* Medium Slate */
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--color-bg);
            color: var(--color-text);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .card {
            background-color: var(--color-card);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.3);
            border-radius: 1rem;
        }
        /* Buttons for the 7 regions */
        .btn-region {
            transition: all 0.2s;
            font-weight: 600;
            padding: 0.75rem 0.5rem;
            border-radius: 0.75rem;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.4);
            text-align: center;
            font-size: 0.875rem; /* Small font for 7 options */
            min-height: 50px;
        }
        .btn-shield { background-color: var(--color-shield); color: var(--color-bg); }
        .btn-cordillera { background-color: var(--color-cordillera); }
        .btn-appalachians { background-color: var(--color-appalachians); }
        .btn-plains { background-color: var(--color-plains); }
        .btn-lowlands { background-color: var(--color-lowlands); }
        .btn-innuitian { background-color: #6366f1; } /* Indigo */
        .btn-hb_arctic { background-color: #06b6d4; } /* Cyan */

        .btn-region:hover:not(:disabled) {
            transform: translateY(-2px);
            opacity: 0.9;
        }
        .correct-answer {
            background-color: #10b981 !important; /* Green */
        }
        .incorrect-answer {
            background-color: #ef4444 !important; /* Red */
        }
        .tab-btn {
            font-size: 1.125rem;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem 0.5rem 0 0;
            cursor: pointer;
            transition: color 0.2s, border-color 0.2s;
            border-bottom: 4px solid transparent;
        }
        .tab-btn.active {
            color: #38bdf8; /* Sky Blue */
            border-color: #38bdf8;
            background-color: #374151;
        }
        .tab-btn:not(.active):hover {
            color: #fff;
        }

        /* Responsive Image Styling */
        .diagram-image {
            width: 100%;
            height: auto;
            border-radius: 0.5rem;
        }
    </style>
</head>
<body>

    <div class="w-full max-w-5xl p-4 md:p-8 space-y-6">
        <header class="text-center">
            <h1 class="text-4xl font-extrabold text-white mb-2">Canada's Landform Regions Challenge: Level 2</h1>
            <p class="text-xl text-gray-400">Master the geological processes, comparisons, and consequences.</p>
        </header>

        <!-- Tab Navigation -->
        <div class="flex space-x-2">
            <button id="tab-quiz" class="tab-btn active" onclick="switchView('quiz')">Quiz Challenge</button>
            <button id="tab-cheat-sheet" class="tab-btn text-gray-400" onclick="switchView('cheat-sheet')">Cheat Sheet</button>
        </div>

        <!-- Main Content Area -->
        <main class="grid grid-cols-1 lg:grid-cols-3 gap-8">

            <!-- Main View Column (Quiz or Cheat Sheet) -->
            <div id="main-view-container" class="lg:col-span-2 card p-6 space-y-6">

                <!-- --- QUIZ VIEW --- -->
                <div id="quiz-view">
                    <h2 class="text-2xl font-bold border-b pb-3 border-gray-600">Region Descriptor Match</h2>
                    
                    <!-- Diagram Toggle -->
                    <div class="mb-4 text-center">
                        <button id="toggle-diagram" onclick="toggleDiagram()" class="text-sm text-gray-300 hover:text-sky-400 focus:outline-none">
                            [Click to Toggle Landform Map]
                        </button>
                        <div id="quiz-diagram-container" class="mt-4 p-3 bg-gray-800 rounded-lg hidden">
                            <!-- Image will be inserted here by JavaScript -->
                        </div>
                    </div>


                    <!-- Question Area -->
                    <div class="bg-gray-700 p-4 rounded-lg shadow-inner min-h-[100px]">
                        <p id="question-number" class="text-sm font-semibold text-gray-400 mb-2">Clue 1/15</p>
                        <p id="question-text" class="text-2xl font-light text-white leading-relaxed">...</p>
                    </div>

                    <!-- Answer Buttons (7 options in a 4x2 grid) -->
                    <div id="answer-buttons" class="grid grid-cols-2 sm:grid-cols-4 gap-4">
                        <button class="btn-region btn-shield" data-answer="Canadian Shield">Canadian Shield</button>
                        <button class="btn-region btn-cordillera" data-answer="Western Cordillera">Western Cordillera</button>
                        <button class="btn-region btn-appalachians" data-answer="Appalachian Mountains">Appalachian Mountains</button>
                        <button class="btn-region btn-plains" data-answer="Interior Plains">Interior Plains</button>
                        <button class="btn-region btn-lowlands" data-answer="Great Lakes-St. Lawrence Lowlands">Great Lakes-St. Lawrence Lowlands</button>
                        <button class="btn-region btn-innuitian" data-answer="Innuitian Mountains">Innuitian Mountains</button>
                        <button class="btn-region btn-hb_arctic" data-answer="Hudson Bay-Arctic Lowlands">Hudson Bay-Arctic Lowlands</button>
                    </div>

                    <!-- Feedback Area -->
                    <div id="feedback-area" class="min-h-[100px] p-4 rounded-lg hidden transition-all duration-300">
                        <h3 id="feedback-title" class="text-xl font-bold mb-2"></h3>
                        <p id="feedback-explanation" class="text-lg"></p>
                    </div>

                    <button id="next-button" class="w-full bg-gray-500 hover:bg-gray-400 text-white font-bold py-3 rounded-lg mt-4 hidden transition-colors" onclick="nextQuestion()">Next Clue &rarr;</button>
                </div>

                <!-- --- CHEAT SHEET VIEW (Visual Cards) --- -->
                <div id="cheat-sheet-view" class="hidden">
                    <h2 class="text-2xl font-bold border-b pb-3 border-gray-600 text-sky-400">Landform Regions Cheat Sheet</h2>
                    <p class="text-gray-300 mb-6">Connect the region's features to its location and formation process.</p>

                    <!-- Landform Map Placeholder -->
                    <div class="mb-8 p-4 bg-gray-800 rounded-xl">
                        <h3 class="text-xl font-bold text-teal-400 mb-3">Map of Landform Regions</h3>
                        <div id="cheat-sheet-diagram-container">
                             <!-- Image will be inserted here by JavaScript -->
                        </div>
                    </div>

                    <!-- --- UPDATED STRATEGY SECTION (STEP 1 IS NOW SIGNATURE FEATURE) --- -->
                    <div class="p-5 rounded-xl border-t-8 border-gray-400 bg-gray-700 space-y-4 mb-8">
                        <h3 class="text-3xl font-extrabold text-gray-200 mb-2 flex items-center">
                            üß† Advanced Question Elimination Strategy
                        </h3>
                        <p class="text-gray-300">Use these 3 steps to eliminate choices quickly on Level 2 questions:</p>
                        
                        <div class="space-y-3">
                            
                            <!-- Step 1 (Now Step 3 in old file) -->
                            <div class="p-3 rounded-lg bg-gray-800">
                                <p class="font-bold text-xl mb-1 text-sky-300">Step 1: Signature Feature Match üó∫Ô∏è (The Quickest Elimination!)</p>
                                <p class="text-sm text-gray-300">Does the question use a unique, hard-to-miss geographic feature?</p>
                                <ul class="list-disc list-inside ml-4 mt-2 text-sm text-gray-400">
                                    <li>**Niagara Escarpment / Rift Valley / Most Populated** üèôÔ∏è: **Great Lakes-St. Lawrence Lowlands**.</li>
                                    <li>**Lake Agassiz / Stepped Plains / Differential Erosion** üåæ: **Interior Plains**.</li>
                                    <li>**Swampy Forest / Lignite Coal / Rests on Shield** üå≤: **Hudson Bay-Arctic Lowlands**.</li>
                                    <li>**Fjords / Highest, Rugged Peaks** üèîÔ∏è: **Western Cordillera**.</li>
                                    <li>**Rounded Peaks / Drowned Coastline (Harbours)** üçÇ: **Appalachian Mountains**.</li>
                                    <li>**Metallic Minerals / Oldest Rocks** üõ°Ô∏è: **Canadian Shield**.</li>
                                </ul>
                            </div>

                            <!-- Step 2 (Now Step 1 in old file) -->
                            <div class="p-3 rounded-lg bg-gray-800">
                                <p class="font-bold text-xl mb-1 text-red-300">Step 2: Rock Type and Mineral Wealth üíé</p>
                                <p class="text-sm text-gray-300">Use the general geological composition to cut the options by Lowlands/Highlands/Shield.</p>
                                <ul class="list-disc list-inside ml-4 mt-2 text-sm text-gray-400">
                                    <li>If the clue mentions **Metallic Minerals (Copper, Gold)** or **Igneous/Magma** üåã: **Only consider the Canadian Shield üõ°Ô∏è**. Eliminate ALL Sedimentary regions.</li>
                                    <li>If the clue mentions **Oil, Gas, Potash, or Fossils** üõ¢Ô∏è: **Only consider Sedimentary regions (Lowlands & Plains)**. Eliminate the Shield.</li>
                                </ul>
                            </div>

                            <!-- Step 3 (Now Step 2 in old file) -->
                            <div class="p-3 rounded-lg bg-gray-800">
                                <p class="font-bold text-xl mb-1 text-yellow-300">Step 3: Age and Erosion (Highlands Only) ‚è≥</p>
                                <p class="text-sm text-gray-300">If the question describes mountain shape, use age to decide between the three Highlands:</p>
                                <ul class="list-disc list-inside ml-4 mt-2 text-sm text-gray-400">
                                    <li>**Oldest/Most Eroded** üçÇ: **Appalachian Mountains**.</li>
                                    <li>**Youngest/Least Eroded** üèîÔ∏è: **Western Cordillera**.</li>
                                    <li>**Mid-age/Barren Arctic** üßä: **Innuitian Mountains**.</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <!-- --- END UPDATED STRATEGY SECTION --- -->

                    <div class="space-y-6">
                        <!-- Canadian Shield -->
                        <div class="p-4 rounded-xl border-t-8 border-yellow-500 bg-gray-700">
                            <h3 class="text-3xl font-extrabold text-yellow-400 mb-2 flex items-center">
                                Canadian Shield üõ°Ô∏è
                            </h3>
                            <p class="text-lg font-semibold text-gray-300 mb-3">Geology: **Igneous & Metamorphic**. World's oldest rocks. </p>
                            <div class="p-3 bg-yellow-800/20 rounded-lg">
                                <p class="font-bold text-xl mb-1">Clue: Storehouse of Metallic Minerals</p>
                                <p class="text-sm">Roots of ancient mountains, now rounded hills. Contains vast deposits of gold, copper, nickel, and diamonds.</p>
                            </div>
                        </div>

                        <!-- Highland Group -->
                        <h2 class="text-2xl font-bold border-b pb-3 border-gray-600 text-white mt-8">Highland Regions (Sorted Oldest to Youngest) ‚õ∞Ô∏è</h2>

                        <!-- Appalachian Mountains (Oldest Highland) -->
                        <div class="p-4 rounded-xl border-t-8 border-rose-600 bg-gray-700">
                            <h3 class="text-3xl font-extrabold text-rose-400 mb-2 flex items-center">
                                Appalachian Mountains üçÇ
                            </h3>
                            <p class="text-lg font-semibold text-gray-300 mb-3">Geology: Sedimentary rock, uplifted and folded 300 million years ago.</p>
                            <div class="p-3 bg-rose-800/20 rounded-lg">
                                <p class="font-bold text-xl mb-1">Clue: Oldest Highland, Drowned Coastline</p>
                                <p class="text-sm">Rounded hills due to billions of years of erosion. Long bays provide deep harbours; rich in non-metallic minerals (coal).</p>
                            </div>
                        </div>

                        <!-- Innuitian Mountains (Middle Highland) -->
                        <div class="p-4 rounded-xl border-t-8 border-indigo-600 bg-gray-700">
                            <h3 class="text-3xl font-extrabold text-indigo-400 mb-2 flex items-center">
                                Innuitian Mountains üßä
                            </h3>
                            <p class="text-lg font-semibold text-gray-300 mb-3">Geology: Mostly Sedimentary rock. Formed mid-Mesozoic era.</p>
                            <div class="p-3 bg-indigo-800/20 rounded-lg">
                                <p class="font-bold text-xl mb-1">Clue: Barren, Remote, Ice-covered North</p>
                                <p class="text-sm">Younger than Appalachians, older than Cordillera. Mineral resources exist but are too costly to exploit due to location.</p>
                            </div>
                        </div>

                        <!-- Western Cordillera (Youngest Highland) -->
                        <div class="p-4 rounded-xl border-t-8 border-green-600 bg-gray-700">
                            <h3 class="text-3xl font-extrabold text-green-400 mb-2 flex items-center">
                                Western Cordillera üèîÔ∏è
                            </h3>
                            <p class="text-lg font-semibold text-gray-300 mb-3">Geology: Varied (Folding, Faulting, Volcanic). Formed by plate subduction.</p>
                            <div class="p-3 bg-green-800/20 rounded-lg">
                                <p class="font-bold text-xl mb-1">Clue: Youngest & Most Rugged</p>
                                <p class="text-sm">High, rugged mountains (Rockies, Coast, Columbia). Features **fjords** (drowned glacial valleys) along the coast.</p>
                            </div>
                        </div>
                        
                        <!-- Lowlands Group -->
                        <h2 class="text-2xl font-bold border-b pb-3 border-gray-600 text-white mt-8">Lowland Regions (Flat/Sedimentary) üåæ</h2>

                        <!-- Interior Plains -->
                        <div class="p-4 rounded-xl border-t-8 border-orange-600 bg-gray-700">
                            <h3 class="text-3xl font-extrabold text-orange-400 mb-2 flex items-center">
                                Interior Plains üåæ
                            </h3>
                            <p class="text-lg font-semibold text-gray-300 mb-3">Geology: **Sedimentary** rock from Shield sediments deposited in ancient seas.</p>
                            <div class="p-3 bg-orange-800/20 rounded-lg">
                                <p class="font-bold text-xl mb-1">Clue: Canada's Breadbasket, Oil/Gas Deposits</p>
                                <p class="text-sm">Rolling hills, deep valleys, sloping west to east. Rich soil from Lake Agassiz remnants; oil, gas, and potash from ancient coral reefs.</p>
                            </div>
                        </div>

                        <!-- Great Lakes-St. Lawrence Lowlands -->
                        <div class="p-4 rounded-xl border-t-8 border-sky-600 bg-gray-700">
                            <h3 class="text-3xl font-extrabold text-sky-400 mb-2 flex items-center">
                                Great Lakes-St. Lawrence Lowlands üèôÔ∏è
                            </h3>
                            <p class="text-lg font-semibold text-gray-300 mb-3">Geology: **Sedimentary** rock. St. Lawrence formed by a **rift valley** (faulting).</p>
                            <div class="p-3 bg-sky-800/20 rounded-lg">
                                <p class="font-bold text-xl mb-1">Clue: Most Populated, Niagara Escarpment</p>
                                <p class="text-sm">Smallest region. Flat/rolling landscape ideal for farming and cities. Glaciers carved out the Great Lakes basins.</p>
                            </div>
                        </div>

                        <!-- Hudson Bay-Arctic Lowlands -->
                        <div class="p-4 rounded-xl border-t-8 border-cyan-600 bg-gray-700">
                            <h3 class="text-3xl font-extrabold text-cyan-400 mb-2 flex items-center">
                                Hudson Bay-Arctic Lowlands üå≤
                            </h3>
                            <p class="text-lg font-semibold text-gray-300 mb-3">Geology: **Sedimentary** rock resting on top of Canadian Shield rock.</p>
                            <div class="p-3 bg-cyan-800/20 rounded-lg">
                                <p class="font-bold text-xl mb-1">Clue: Flat, Swampy, Deposits of Lignite</p>
                                <p class="text-sm">Very low-lying area. Hudson Bay Lowlands are swampy forest. Arctic Lowlands contain lignite, oil, and natural gas deposits.</p>
                            </div>
                        </div>

                    </div>
                </div>

            </div>

            <!-- Score/Reference Column -->
            <div class="lg:col-span-1 space-y-6">
                <div id="score-box" class="card p-4 text-center">
                    <p class="text-lg font-semibold text-gray-400">Your Current Score:</p>
                    <p id="score-display" class="text-5xl font-extrabold text-teal-400">0/0</p>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Data structure for the quiz (UPDATED FOR LEVEL 2 - Comparison, Process Detail, Application)
        const quizData = [
            // 1. Comparison: Age/Erosion
            {
                question: "A geologist observes two mountain ranges. One has **rounded, heavily eroded peaks**; the other has **sharp, rugged peaks**. Which region corresponds to the **older, rounded** peaks?",
                answer: "Appalachian Mountains",
                explanation: {
                    correct: "Correct! The **Appalachian Mountains** üçÇ are the **oldest highland region** (formed 300 million years ago!). Millions of years of wind, water, and ice have worn their peaks down and made them rounded. This shows the power of **Erosion**! ‚è≥",
                    incorrect: (selectedAnswer) => {
                        let ambiguityNote = '';
                        if (selectedAnswer === "Western Cordillera") {
                            ambiguityNote = 'You may have mistaken the **Western Cordillera** üèîÔ∏è for the older range. However, the Cordillera is the **youngest** region. Its dramatic, **sharp peaks** indicate it hasn\'t had as much time to be worn down by erosion.';
                        } else if (selectedAnswer === "Canadian Shield") {
                            ambiguityNote = 'You chose the **Canadian Shield** üõ°Ô∏è. The Shield is the oldest of all regions, but it is characterized by **rounded hills** (roots of ancient mountains), not towering mountain peaks.';
                        } else {
                            ambiguityNote = `You chose the **${selectedAnswer}** ‚ùå. This is a lowland or a different highland region and is not known for having the oldest, most rounded mountain peaks in Canada.`;
                        }
                        return `‚ùå **Incorrect.** ${ambiguityNote}`;
                    }
                },
                clue_type: "Comparison",
            },
            // 2. Application: Mineral Association
            {
                question: "Which region's economic backbone is its concentration of **metallic minerals** (like copper, nickel, and gold), formed from cooling magma, contrasting with other regions rich in sedimentary fossil fuels?",
                answer: "Canadian Shield",
                explanation: {
                    correct: "Correct! The **Canadian Shield** üõ°Ô∏è is called the **\"storehouse of metallic minerals\"** üíé. These deposits formed when molten rock (magma) üåã cooled slowly, allowing the minerals to crystallize and separate inside the Igneous and Metamorphic rock.",
                    incorrect: (selectedAnswer) => {
                        let ambiguityNote = `You chose the **${selectedAnswer}** ‚ùå. This region is primarily built on sedimentary rock, which **DOES NOT** contain significant metallic mineral deposits.`;
                        if (selectedAnswer === "Interior Plains") {
                             ambiguityNote = 'You chose the **Interior Plains** üåæ. While the Interior Plains are rich, their wealth is in *non-metallic, sedimentary* fossil fuels (oil, gas) and potash, not the *metallic, igneous* minerals found in the Shield.';
                        } else if (selectedAnswer === "Great Lakes-St. Lawrence Lowlands") {
                            ambiguityNote = 'You chose the **Great Lakes-St. Lawrence Lowlands** üèôÔ∏è. Like the Interior Plains, this region is built on **sedimentary rock**, meaning it is wealthy due to fertile soil and urban development, **not** metallic mineral deposits formed from cooling magma.';
                        }
                        return `‚ùå **Incorrect.** ${ambiguityNote}`;
                    }
                },
                clue_type: "Application (Mineral)",
            },
            // 3. Process Detail: Rift Valley
            {
                question: "The St. Lawrence Lowland was formed when the land between two **faults** collapsed, creating a major geological structure known as a:",
                answer: "Great Lakes-St. Lawrence Lowlands",
                explanation: {
                    correct: "Correct! The St. Lawrence portion was created by **double faulting** üí•, where sections of the crust moved apart, causing the middle block to drop down, forming a **rift valley** ‚¨áÔ∏è.",
                    incorrect: (selectedAnswer) => {
                        let ambiguityNote = `You chose the **${selectedAnswer}** ‚ùå. This region was not created by the unique **rift valley** mechanism.`;
                        if (selectedAnswer === "Western Cordillera") {
                            ambiguityNote = 'You may have confused this with the Cordillera üèîÔ∏è, which was uplifted by plate *collision* (**subduction**) and folding, not a crustal collapse (faulting).';
                        }
                        return `‚ùå **Incorrect.** ${ambiguityNote}`;
                    }
                },
                clue_type: "Process Detail (Rift)",
            },
            // 4. Application: Ancient Life/Fossil Fuels
            {
                question: "The presence of commercial quantities of **oil and natural gas** in the Interior Plains is directly linked to the ancient existence of compressed organic material from:",
                answer: "Interior Plains",
                explanation: {
                    correct: "Correct! The oil and gas in the **Interior Plains** üõ¢Ô∏è originated from ancient **coral reefs** üê† and microscopic organisms that lived in the shallow inland seas. Over millions of years, heat and pressure turned this organic material into fossil fuels within the sedimentary rock.",
                    incorrect: (selectedAnswer) => {
                        let ambiguityNote = `You chose the **${selectedAnswer}** ‚ùå. This region either lacks sedimentary rock or the specific type of ancient life needed to form large fossil fuel deposits.`;
                        if (selectedAnswer === "Canadian Shield") {
                            ambiguityNote = 'You chose the **Canadian Shield** üõ°Ô∏è. The Shield is largely igneous and metamorphic rock from the Precambrian era, *before* the types of life forms existed that produced oil and gas. Therefore, the Shield **does not contain fossil fuels** like oil and gas.';
                        }
                        return `‚ùå **Incorrect.** ${ambiguityNote}`;
                    }
                },
                clue_type: "Application (Fossil Fuel)",
            },
            // 5. Application: Differential Erosion
            {
                question: "The three different levels of elevation across the Interior Plains (separated by escarpments) are the result of **harder rocks resisting erosion** more than softer rocks. This process is called:",
                answer: "Interior Plains",
                explanation: {
                    correct: "Correct! This process is called **differential erosion** ‚úÇÔ∏è. The **Interior Plains** üåæ have alternating layers of hard and soft sedimentary rock. The hard layers erode slowly, protecting the rock underneath and creating the sharp rises (escarpments) between the flat plains.",
                    incorrect: (selectedAnswer) => {
                        let ambiguityNote = `You chose the **${selectedAnswer}** ‚ùå. This process (differential erosion) is the key feature creating the stepped landscape of the Interior Plains.`;
                        if (selectedAnswer === "Canadian Shield") {
                            ambiguityNote = 'You chose the **Canadian Shield** üõ°Ô∏è. The Shield has a rounded, relatively flat topography due to billions of years of *uniform* (or non-differential) erosion.';
                        }
                        return `‚ùå **Incorrect.** ${ambiguityNote}`;
                    }
                },
                clue_type: "Application (Erosion)",
            },
            // 6. Comparison: Younger Highlands
            {
                question: "Both the Appalachian and Innuitian Mountains formed from folded sedimentary rock, but the Innuitians have less erosion because they formed later, in the **Middle of the Mesozoic Era**. Which region is younger than the Appalachians but older than the Cordillera?",
                answer: "Innuitian Mountains",
                explanation: {
                    correct: "Correct! The **Innuitian Mountains** üßä are the **\"middle child\"** in age. They formed after the Appalachians (Paleozoic) but before the Western Cordillera (Cenozoic), giving them higher, less rounded peaks than the Appalachians.",
                    incorrect: (selectedAnswer) => {
                        let ambiguityNote = `You chose the **${selectedAnswer}** ‚ùå. This region does not fit the specific age profile (younger than Appalachians, older than Cordillera).`;
                        if (selectedAnswer === "Western Cordillera") {
                            ambiguityNote = 'You chose the **Western Cordillera** üèîÔ∏è, which is the **youngest** highland region in Canada. Its peaks are the sharpest and most dramatic, and are not the "middle age" range being described.';
                        }
                        return `‚ùå **Incorrect.** ${ambiguityNote}`;
                    }
                },
                clue_type: "Comparison (Age)",
            },
            // 7. Consequence: Drowned Coastline/Fjords
            {
                question: "The flooding of former river valleys by rising sea levels (due to the melting of ice and land sinking) in coastal areas leads to the formation of: ",
                answer: "Western Cordillera",
                explanation: {
                    correct: "Correct! The glaciated coastal valleys in the **Western Cordillera** üåä were flooded by the sea, creating spectacular, deep, narrow inlets called **fjords** üõ∂. This is a consequence of glaciation and sea level change.",
                    incorrect: (selectedAnswer) => {
                        let ambiguityNote = `You chose the **${selectedAnswer}** ‚ùå. While many regions have coastal features, the formation of **fjords** (drowned glacial valleys) is the signature coastal feature of the Cordillera.`;
                        if (selectedAnswer === "Appalachian Mountains") {
                            ambiguityNote = 'You chose the **Appalachian Mountains** üçÇ. While the Appalachians have a "drowned coastline" with long bays, the term **fjord** specifically refers to the deep, U-shaped glacial valleys common along the rugged British Columbia coast (Western Cordillera).';
                        }
                        return `‚ùå **Incorrect.** ${ambiguityNote}`;
                    }
                },
                clue_type: "Consequence (Fjords)",
            },
            // 8. Definition: Source of Lowland Bedrock
            {
                question: "The sedimentary bedrock underlying all three lowland regions (Interior Plains, Great Lakes, Hudson Bay) was formed primarily from:",
                answer: "Canadian Shield",
                explanation: {
                    correct: "Correct! The **Canadian Shield** üõ°Ô∏è is the geological foundation of Canada. Over billions of years, its ancient rocks eroded üí®, and the resulting sediments were washed into the surrounding seas, forming the sedimentary rock layers that became the Lowlands.",
                    incorrect: (selectedAnswer) => {
                        let ambiguityNote = `You chose the **${selectedAnswer}** ‚ùå. While this region is built on sedimentary rock, it did not provide the original material.`;
                        if (selectedAnswer === "Interior Plains") {
                            ambiguityNote = 'You chose the **Interior Plains** üåæ. While the Plains are built on sedimentary rock, that rock material **originated from the erosion of the ancient Canadian Shield**, not from the Interior Plains itself.';
                        }
                        return `‚ùå **Incorrect.** ${ambiguityNote}`;
                    }
                },
                clue_type: "Definition (Source)",
            },
            // 9. Application: Glacial Lakes
            {
                question: "The massive flat plains and **fertile soil** that characterize Southern Manitoba were created by sediments deposited on the bottom of a huge ancient body of water called:",
                answer: "Interior Plains",
                explanation: {
                    correct: "Correct! This huge ancient body was **Lake Agassiz** üèûÔ∏è. When the glaciers melted, this massive lake formed and then drained. It left behind the deep, flat, nutrient-rich lake bed sediments that make the **Interior Plains** üåæ the **\"breadbasket\"** of Canada.",
                    incorrect: (selectedAnswer) => {
                        let ambiguityNote = `You chose the **${selectedAnswer}** ‚ùå. While this region was affected by glaciation, it was not the site of the massive Lake Agassiz and its signature fertile plain.`;
                        if (selectedAnswer === "Great Lakes-St. Lawrence Lowlands") {
                            ambiguityNote = 'You chose the **Great Lakes-St. Lawrence Lowlands** üèôÔ∏è. This area also saw large glacial lakes (like Lake Iroquois), but the massive, fertile flat plain of Southern Manitoba (the "breadbasket") is the definitive consequence of Lake Agassiz in the Interior Plains.';
                        }
                        return `‚ùå **Incorrect.** ${ambiguityNote}`;
                    }
                },
                clue_type: "Application (Glacial Lakes)",
            },
            // 10. Synthesis: Low-lying Features
            {
                question: "This region is characterized by flat, low-lying, **swampy** land where thin sedimentary rock layers rest directly on the Shield, containing deposits of **lignite coal**.",
                answer: "Hudson Bay-Arctic Lowlands",
                explanation: {
                    correct: "Correct! The **Hudson Bay-Arctic Lowlands** üå≤ are defined by this low, wet topography near the Bay (due to recent glaciation and marine deposits) and the presence of **lignite** (low-quality coal) in the Arctic islands.",
                    incorrect: (selectedAnswer) => {
                        let ambiguityNote = `You chose the **${selectedAnswer}** ‚ùå. This region is not characterized by the unique combination of **swampy forest** and **lignite coal** deposits.`;
                        if (selectedAnswer === "Great Lakes-St. Lawrence Lowlands") {
                             ambiguityNote = 'You chose the **Great Lakes-St. Lawrence Lowlands** üèôÔ∏è. While flat, this is the urban and industrial center, not the low-lying, vast **swampy forest** containing lignite coal deposits, which is unique to the Hudson Bay Lowlands.';
                        }
                        return `‚ùå **Incorrect.** ${ambiguityNote}`;
                    }
                },
                clue_type: "Synthesis (Lowlands)",
            },
            // 11. NEW: Shield - Disorganized Drainage/Glaciation
            {
                question: "The **disorganized drainage pattern** of winding rivers, lakes, and swamps across the Canadian Shield is a direct consequence of which specific geological event?",
                answer: "Canadian Shield",
                explanation: {
                    correct: "Correct! The Shield's drainage is a consequence of the **Glaciers** üßä. The ice scraped the bedrock, creating depressions that became lakes, and deposited material that **dammed and redirected** the rivers, resulting in the chaotic, disorganized pattern üåä.",
                    incorrect: (selectedAnswer) => {
                        let ambiguityNote = `You chose the **${selectedAnswer}** ‚ùå. While glaciation affected many regions, the unique combination of **impervious bedrock** and **glacial gouging** that led to this specific, disorganized drainage pattern is the signature of the Canadian Shield.`;
                        return `‚ùå **Incorrect.** ${ambiguityNote}`;
                    }
                },
                clue_type: "Consequence (Glaciation)",
            },
            // 12. NEW: Appalachians - Formation Process
            {
                question: "Which region was formed by the **continental collision** of the North American plate with Europe and northern Africa during the assembly of Pangaea?",
                answer: "Appalachian Mountains",
                explanation: {
                    correct: "Correct! The **Appalachian Mountains** üçÇ were uplifted and folded 300 million years ago when the North American plate crashed into Europe and northern Africa üí• during the assembly of **Pangaea** üó∫Ô∏è.",
                    incorrect: (selectedAnswer) => {
                        let ambiguityNote = `You chose the **${selectedAnswer}** ‚ùå. While this region is a highland, it formed either through subduction (Cordillera) or later, less dramatic folding (Innuitian), not the immense, ancient continental collision that formed the Appalachians.`;
                        return `‚ùå **Incorrect.** ${ambiguityNote}`;
                    }
                },
                clue_type: "Process Detail (Collision)",
            },
            // 13. NEW: Cordillera - Limitation/Transportation
            {
                question: "The primarily **north-south orientation** of the mountains and valleys in this region creates a major obstacle for which necessary human activity?",
                answer: "Western Cordillera",
                explanation: {
                    correct: "Correct! The mountains and valleys of the **Western Cordillera** üèîÔ∏è run **north-south** ‚ÜïÔ∏è. This makes **east-west transportation** ‚û°Ô∏è‚¨ÖÔ∏è (highways, railways) extremely difficult, forcing travel through a few, expensive mountain passes.",
                    incorrect: (selectedAnswer) => {
                        let ambiguityNote = `You chose the **${selectedAnswer}** ‚ùå. This activity is uniquely hindered by the powerful, un-eroded north-south ranges of the Cordillera. The Appalachians, for example, have been eroded enough to allow easier passage.`;
                        return `‚ùå **Incorrect.** ${ambiguityNote}`;
                    }
                },
                clue_type: "Consequence (Transportation)",
            },
            // 14. NEW: Great Lakes - Glaciation Effect
            {
                question: "The large, deep basins that contain the Great Lakes were physically created by which intense geological action?",
                answer: "Great Lakes-St. Lawrence Lowlands",
                explanation: {
                    correct: "Correct! The Great Lakes are located in basins that were physically **gouged out and deepened** by the enormous weight and scraping action of the **Glaciers** üßä during the last Ice Age.",
                    incorrect: (selectedAnswer) => {
                        let ambiguityNote = `You chose the **${selectedAnswer}** ‚ùå. While other regions were affected by glaciers, the specific creation and deepening of the Great Lakes basins is a signature feature of the Great Lakes-St. Lawrence Lowlands.`;
                        return `‚ùå **Incorrect.** ${ambiguityNote}`;
                    }
                },
                clue_type: "Process Detail (Glacial)",
            },
            // 15. NEW: Innuitian - Non-Development
            {
                question: "Although this mountain region contains valuable mineral resources (similar to the Appalachians), they are generally **not exploited** because of the extreme **remote location** and cost.",
                answer: "Innuitian Mountains",
                explanation: {
                    correct: "Correct! The **Innuitian Mountains** üßä are so far north and **remote** ü•∂ that the high **cost** üí∏ of transportation and development outweighs the value of the minerals, leaving them unexploited for now.",
                    incorrect: (selectedAnswer) => {
                        let ambiguityNote = `You chose the **${selectedAnswer}** ‚ùå. This region, while potentially resource-rich, is geographically accessible or its resources are actively mined (like the Shield or Cordillera), unlike the remote Innuitians.`;
                        return `‚ùå **Incorrect.** ${ambiguityNote}`;
                    }
                },
                clue_type: "Synthesis (Economics)",
            }
        ].sort(() => Math.random() - 0.5); // Shuffle the questions

        let currentQuestionIndex = 0;
        let score = 0;
        const totalQuestions = quizData.length;

        // Landform Map Image FIX: Updated to the correct GitHub "Raw" content URL.
        const landformDiagramUrl = "https://raw.githubusercontent.com/srikantsortur-tech/geo-b5-landform-region/main/images/CanadaLandform.png"; 
        
        // This is the HTML structure for the diagram (using the image URL)
        const landformDiagramHtml = `<img src="${landformDiagramUrl}" onerror="this.onerror=null; this.src='https://placehold.co/800x450/cc5500/ffffff?text=Image+Loading+Error.+Check+GitHub+Raw+URL';" alt="Map of Canada's Landform Regions" class="diagram-image">`;


        // DOM elements
        const questionNumberEl = document.getElementById('question-number');
        const questionTextEl = document.getElementById('question-text');
        const answerButtonsContainer = document.getElementById('answer-buttons');
        const feedbackArea = document.getElementById('feedback-area');
        const feedbackTitleEl = document.getElementById('feedback-title');
        const feedbackExplanationEl = document.getElementById('feedback-explanation');
        const nextButton = document.getElementById('next-button');
        const scoreDisplay = document.getElementById('score-display');
        
        const quizView = document.getElementById('quiz-view');
        const cheatSheetView = document.getElementById('cheat-sheet-view');
        const tabQuiz = document.getElementById('tab-quiz');
        const tabCheatSheet = document.getElementById('tab-cheat-sheet');
        
        const quizDiagramContainer = document.getElementById('quiz-diagram-container');
        const cheatSheetDiagramContainer = document.getElementById('cheat-sheet-diagram-container');

        // --- VIEW SWITCHING LOGIC ---
        window.switchView = function(viewName) {
            if (viewName === 'quiz') {
                quizView.classList.remove('hidden');
                cheatSheetView.classList.add('hidden');
                tabQuiz.classList.add('active');
                tabCheatSheet.classList.remove('active');
                tabQuiz.classList.remove('text-gray-400');
                tabCheatSheet.classList.add('text-gray-400');
            } else if (viewName === 'cheat-sheet') {
                quizView.classList.add('hidden');
                cheatSheetView.classList.remove('hidden');
                tabCheatSheet.classList.add('active');
                tabQuiz.classList.remove('active');
                tabCheatSheet.classList.remove('text-gray-400');
                tabQuiz.classList.add('text-gray-400');
            }
        }
        
        // --- DIAGRAM TOGGLE LOGIC ---
        window.toggleDiagram = function() {
            quizDiagramContainer.classList.toggle('hidden');
            const button = document.getElementById('toggle-diagram');
            if (quizDiagramContainer.classList.contains('hidden')) {
                button.textContent = '[Click to Toggle Landform Map]';
            } else {
                button.textContent = '[Click to Hide Landform Map]';
            }
        }

        // Function to load the current question
        function loadQuestion() {
            if (currentQuestionIndex >= totalQuestions) {
                showResults();
                return;
            }

            const currentQ = quizData[currentQuestionIndex];
            
            // Reset UI
            feedbackArea.classList.add('hidden');
            nextButton.classList.add('hidden');
            Array.from(answerButtonsContainer.children).forEach(button => {
                button.disabled = false;
                button.classList.remove('correct-answer', 'incorrect-answer');
                // Ensure proper class is re-applied
                const answerType = button.dataset.answer;
                button.className = 'btn-region'; // Base class
                if (answerType.includes('Shield')) {
                    button.classList.add('btn-shield');
                } else if (answerType.includes('Cordillera')) {
                    button.classList.add('btn-cordillera');
                } else if (answerType.includes('Appalachian')) {
                    button.classList.add('btn-appalachians');
                } else if (answerType.includes('Plains')) {
                    button.classList.add('btn-plains');
                } else if (answerType.includes('Lowlands')) {
                    button.classList.add('btn-lowlands');
                } else if (answerType.includes('Innuitian')) {
                    button.classList.add('btn-innuitian');
                } else if (answerType.includes('Hudson Bay-Arctic')) {
                    button.classList.add('btn-hb_arctic');
                }
            });

            // Update question text
            questionNumberEl.textContent = `Clue ${currentQuestionIndex + 1}/${totalQuestions}`;
            questionTextEl.innerHTML = currentQ.question;
            scoreDisplay.textContent = `${score}/${currentQuestionIndex}`;
        }

        // Function to handle the user's answer
        function selectAnswer(event) {
            const selectedButton = event.target;
            if (!selectedButton.classList.contains('btn-region')) return;

            const selectedAnswer = selectedButton.dataset.answer;
            const currentQData = quizData[currentQuestionIndex];
            const correctAnswer = currentQData.answer;
            
            let feedbackText;
            
            // Determine the feedback text based on correctness
            if (selectedAnswer === correctAnswer) {
                score++;
                selectedButton.classList.add('correct-answer');
                feedbackArea.style.backgroundColor = 'rgba(16, 185, 129, 0.2)'; // Green transparent
                feedbackTitleEl.textContent = "‚úÖ Excellent! Level 2 Mastered!";
                feedbackTitleEl.classList.remove('text-red-400');
                feedbackTitleEl.classList.add('text-green-400');
                feedbackText = currentQData.explanation.correct;
            } else {
                selectedButton.classList.add('incorrect-answer');
                // Find the correct button and highlight it
                const correctButton = Array.from(answerButtonsContainer.children).find(btn => btn.dataset.answer === correctAnswer);
                correctButton.classList.add('correct-answer');

                feedbackArea.style.backgroundColor = 'rgba(239, 68, 68, 0.2)'; // Red transparent
                feedbackTitleEl.textContent = "‚ùå Not Quite. Let's Break Down the Geology!";
                feedbackTitleEl.classList.remove('text-green-400');
                feedbackTitleEl.classList.add('text-red-400');
                
                // --- CUSTOMIZED FEEDBACK GENERATION ---
                const incorrectExplanation = currentQData.explanation.incorrect(selectedAnswer);
                const correctExplanation = currentQData.explanation.correct;

                // Add a specific "Also Note" section for the closest ambiguous answer (Interior Plains in this case)
                let secondaryNote = '';
                if (correctAnswer === "Canadian Shield" && selectedAnswer !== "Interior Plains") {
                    secondaryNote = `<br><br>ü§î **Common Ambiguity:** People often confuse the Shield with the **Interior Plains** üåæ because both are resource-rich. However, the Plains only have non-metallic resources (oil, gas, potash) in their **sedimentary rock**, while the Shield has **metallic** resources in its **igneous rock** üõ°Ô∏è.`;
                }
                // --- END CUSTOMIZED FEEDBACK GENERATION ---

                feedbackText = incorrectExplanation + secondaryNote + '<br><br>üëâ **The Correct Insight:** ' + correctExplanation;
            }

            // Disable all buttons and show feedback
            Array.from(answerButtonsContainer.children).forEach(button => {
                button.disabled = true;
            });
            feedbackArea.classList.remove('hidden');
            nextButton.classList.remove('hidden');

            feedbackExplanationEl.innerHTML = feedbackText;
            scoreDisplay.textContent = `${score}/${currentQuestionIndex + 1}`;
        }

        // Function to move to the next question
        function nextQuestion() {
            currentQuestionIndex++;
            loadQuestion();
        }

        // Function to show final results
        function showResults() {
            questionNumberEl.textContent = `Level 2 Challenge Complete!`;
            questionTextEl.innerHTML = `You finished the Level 2 quiz! You scored **${score} out of ${totalQuestions}** (${Math.round((score / totalQuestions) * 100)}%). Your understanding of geological processes is strong!`;

            answerButtonsContainer.innerHTML = '';
            feedbackArea.classList.remove('hidden');
            feedbackArea.style.backgroundColor = 'rgba(74, 222, 128, 0.2)';
            feedbackTitleEl.textContent = 'Next Steps:';
            feedbackTitleEl.classList.remove('text-red-400');
            feedbackTitleEl.classList.add('text-green-400');
            feedbackExplanationEl.innerHTML = 'Review the detailed Level 2 explanations. You can refresh the page to restart the challenge!';
            nextButton.classList.add('hidden');
        }

        // Initial setup
        window.onload = function() {
            // Insert the HTML image into both containers
            quizDiagramContainer.innerHTML = landformDiagramHtml;
            cheatSheetDiagramContainer.innerHTML = landformDiagramHtml;
            loadQuestion();
            // Attach event listener to answer buttons
            answerButtonsContainer.addEventListener('click', selectAnswer);
        };
    </script>

</body>
</html>
